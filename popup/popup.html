<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="../styles/popup.css">
</head>

<body>
<div id="status" class="status"></div>

<!-- Header -->
<div class="header">
  <svg class="header-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z">
    </path>
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
  </svg>
  <h1 class="header-title">Grindr Auto Tap</h1>
</div>

<!-- Tabs -->
<div class="tabs">
  <button class="tab active" data-tab="actions">‚öôÔ∏è Actions</button>
  <button class="tab" data-tab="auth">üîê Auth</button>
  <button class="tab" data-tab="webhook">üì° n8n</button>
  <button class="tab" data-tab="logs">üìã Logs</button>
</div>

<!-- Tab Content: Actions -->
<div class="tab-content active" id="tabActions">
  <div class="tab-panel">
    <div class="section-header">
      <h3 class="section-title">
        <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
             xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z">
          </path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
          </path>
        </svg>
        Actions
      </h3>
      <button class="btn btn-icon" id="editMinDelay" title="Modifier">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
          </path>
        </svg>
      </button>
    </div>

    <div class="section-actions">
      <div class="checkbox-row">
        <label for="autoStart">D√©marrage automatique</label>
        <label class="toggle-switch">
          <input type="checkbox" id="autoStart">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="info-row">
        <span class="info-label">D√©lai min (h):</span>
        <span class="info-value" id="minDelayDisplay">12</span>
      </div>

      <div id="minDelayEdit" class="hidden">
        <div class="edit-row">
          <label>Heures:</label>
          <input type="number" id="minDelayHours" min="0" step="0.5" placeholder="12">
        </div>
      </div>

      <button class="btn btn-primary btn-action" id="startScript">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"
             xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z">
          </path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
          </path>
        </svg>
        D√©marrer
      </button>
      <button class="btn btn-secondary btn-action hidden" id="stopScript">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"
             xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
          </path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10h6v4H9z"></path>
        </svg>
        Arr√™ter
      </button>
    </div>
  </div>
</div>

<!-- Tab Content: Authentification -->
<div class="tab-content" id="tabAuth">
  <div class="tab-panel">
    <div class="section-header">
      <h3 class="section-title">
        <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
             xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z">
          </path>
        </svg>
        Authentification
      </h3>
      <button class="btn btn-icon" id="editAuth" title="Modifier">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
          </path>
        </svg>
      </button>
    </div>

    <!-- Mode affichage -->
    <div id="authDisplay">
      <div class="info-row">
        <span class="info-label">M√©thode:</span>
        <span class="info-value" id="loginMethodDisplay">-</span>
      </div>
      <div class="info-row" id="emailDisplayRow">
        <span class="info-label">Email:</span>
        <span class="info-value" id="emailDisplay">-</span>
      </div>
      <div class="info-row" id="passwordDisplayRow">
        <span class="info-label">Mot de passe:</span>
        <span class="info-value masked" id="passwordDisplay">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
      </div>
      <div class="checkbox-row">
        <label for="autoLoginDisplay">Connexion automatique</label>
        <label class="toggle-switch">
          <input type="checkbox" id="autoLoginDisplay" disabled>
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>

    <!-- Mode √©dition -->
    <div id="authEdit" class="hidden">
      <div class="edit-row">
        <label>M√©thode:</label>
        <select id="loginMethod">
          <option value="email">Email</option>
          <option value="facebook">Facebook</option>
          <option value="google">Google</option>
          <option value="apple">Apple</option>
        </select>
      </div>
      <div id="credentialsFields" class="credentials-fields">
        <div class="edit-row">
          <label>Email:</label>
          <input type="email" id="email" placeholder="votre@email.com">
        </div>
        <div class="edit-row">
          <label>Mot de passe:</label>
          <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        </div>
      </div>
      <div class="checkbox-row">
        <label for="autoLogin">Connexion automatique</label>
        <label class="toggle-switch">
          <input type="checkbox" id="autoLogin">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div style="margin-top: var(--spacing-xs);">
        <button class="btn btn-danger" id="deleteCredentials" title="Supprimer">
          <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"
               xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
            </path>
          </svg>
          Supprimer
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Tab Content: n8n -->
<div class="tab-content" id="tabWebhook">
  <div class="tab-panel">
    <div class="section-header">
      <h3 class="section-title">
        <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
             xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0">
          </path>
        </svg>
        Configuration n8n
      </h3>
      <button class="btn btn-icon" id="editWebhook" title="Modifier">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
          </path>
        </svg>
      </button>
    </div>

    <!-- Mode affichage -->
    <div id="webhookDisplay">
      <div class="info-row">
        <span class="info-label">Webhook URL:</span>
        <span class="info-value" id="webhookURLDisplay">-</span>
      </div>
    </div>

    <!-- Mode √©dition -->
    <div id="webhookEdit" class="hidden">
      <div class="edit-row">
        <label>URL:</label>
        <input type="url" id="webhookURL" placeholder="https://...">
      </div>
    </div>
  </div>
</div>

<!-- Tab Content: Logs -->
<div class="tab-content" id="tabLogs">
  <div class="tab-panel">
    <div class="section-header">
      <h3 class="section-title">
        <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
             xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
          </path>
        </svg>
        Logs de l'extension
      </h3>
      <button class="btn btn-icon" id="clearLogs" title="Effacer les logs">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
          </path>
        </svg>
      </button>
    </div>

    <div id="logsContainer"
         style="max-height: 150px; overflow-y: auto; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 11px; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-sm); padding: var(--spacing-sm);">
      <div style="color: var(--color-text-muted); text-align: center; padding: var(--spacing-md);">
        Chargement des logs...
      </div>
    </div>
  </div>
</div>

<!-- Modal de confirmation -->
<div id="confirmModal" class="modal-overlay">
  <div class="modal">
    <div class="modal-title">Confirmation</div>
    <div class="modal-message" id="confirmMessage">√ätes-vous s√ªr ?</div>
    <div class="modal-buttons">
      <button class="modal-btn modal-btn-cancel" id="confirmCancel">Annuler</button>
      <button class="modal-btn modal-btn-confirm" id="confirmOk">OK</button>
    </div>
  </div>
</div>

<!-- Core utilities -->
<script src="../shared-constants.js"></script>
<script src="../utils/logger.js"></script>
<script src="../utils/messaging.js"></script>

<!-- Popup modules (must load before main entry point) -->
<script src="ui/status-display.js"></script>
<script src="managers/script-manager.js"></script>
<script src="managers/storage-manager.js"></script>
<script src="managers/log-manager.js"></script>
<script src="managers/tab-manager.js"></script>
<script src="edit-mode.js"></script>

<!-- Main entry point (loads last, coordinates all modules) -->
<script src="popup.js"></script>
</body>

</html>